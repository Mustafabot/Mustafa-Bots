var WikiSaikou=function(w){"use strict";/**
* @vue/shared v3.5.8
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function Le(e){const t=Object.create(null);for(const r of e.split(","))t[r]=1;return r=>r in t}const wt=Object.assign,Pe=Object.prototype.hasOwnProperty,z=(e,t)=>Pe.call(e,t),I=Array.isArray,C=e=>oe(e)==="[object Map]",qe=e=>typeof e=="function",Me=e=>typeof e=="string",j=e=>typeof e=="symbol",U=e=>e!==null&&typeof e=="object",je=Object.prototype.toString,oe=e=>je.call(e),ke=e=>oe(e).slice(8,-1),G=e=>Me(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,D=(e,t)=>!Object.is(e,t);/**
* @vue/reactivity v3.5.8
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let d,ie=0,k;function Ae(e){e.flags|=8,e.next=k,k=e}function V(){ie++}function X(){if(--ie>0)return;let e;for(;k;){let t=k;for(k=void 0;t;){const r=t.next;if(t.next=void 0,t.flags&=-9,t.flags&1)try{t.trigger()}catch(n){e||(e=n)}t=r}}if(e)throw e}function He(e){for(let t=e.deps;t;t=t.nextDep)t.version=-1,t.prevActiveLink=t.dep.activeLink,t.dep.activeLink=t}function xe(e,t=!1){let r,n=e.depsTail,s=n;for(;s;){const o=s.prevDep;s.version===-1?(s===n&&(n=o),ce(s,t),Ue(s)):r=s,s.dep.activeLink=s.prevActiveLink,s.prevActiveLink=void 0,s=o}e.deps=r,e.depsTail=n}function Ce(e){for(let t=e.deps;t;t=t.nextDep)if(t.dep.version!==t.version||t.dep.computed&&(ae(t.dep.computed)||t.dep.version!==t.version))return!0;return!!e._dirty}function ae(e){if(e.flags&4&&!(e.flags&16)||(e.flags&=-17,e.globalVersion===A))return;e.globalVersion=A;const t=e.dep;if(e.flags|=2,t.version>0&&!e.isSSR&&e.deps&&!Ce(e)){e.flags&=-3;return}const r=d,n=y;d=e,y=!0;try{He(e);const s=e.fn(e._value);(t.version===0||D(s,e._value))&&(e._value=s,t.version++)}catch(s){throw t.version++,s}finally{d=r,y=n,xe(e,!0),e.flags&=-3}}function ce(e,t=!1){const{dep:r,prevSub:n,nextSub:s}=e;if(n&&(n.nextSub=s,e.prevSub=void 0),s&&(s.prevSub=n,e.nextSub=void 0),r.subs===e&&(r.subs=n),!r.subs)if(r.computed){r.computed.flags&=-5;for(let o=r.computed.deps;o;o=o.nextDep)ce(o,!0)}else r.map&&!t&&(r.map.delete(r.key),r.map.size||N.delete(r.target))}function Ue(e){const{prevDep:t,nextDep:r}=e;t&&(t.nextDep=r,e.prevDep=void 0),r&&(r.prevDep=t,e.nextDep=void 0)}let y=!0;const ue=[];function Ne(){ue.push(y),y=!1}function Ke(){const e=ue.pop();y=e===void 0?!0:e}let A=0;class Fe{constructor(t,r){this.sub=t,this.dep=r,this.version=r.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class Q{constructor(t){this.computed=t,this.version=0,this.activeLink=void 0,this.subs=void 0,this.target=void 0,this.map=void 0,this.key=void 0}track(t){if(!d||!y||d===this.computed)return;let r=this.activeLink;if(r===void 0||r.sub!==d)r=this.activeLink=new Fe(d,this),d.deps?(r.prevDep=d.depsTail,d.depsTail.nextDep=r,d.depsTail=r):d.deps=d.depsTail=r,d.flags&4&&le(r);else if(r.version===-1&&(r.version=this.version,r.nextDep)){const n=r.nextDep;n.prevDep=r.prevDep,r.prevDep&&(r.prevDep.nextDep=n),r.prevDep=d.depsTail,r.nextDep=void 0,d.depsTail.nextDep=r,d.depsTail=r,d.deps===r&&(d.deps=n)}return r}trigger(t){this.version++,A++,this.notify(t)}notify(t){V();try{for(let r=this.subs;r;r=r.prevSub)r.sub.notify()&&r.sub.dep.notify()}finally{X()}}}function le(e){const t=e.dep.computed;if(t&&!e.dep.subs){t.flags|=20;for(let n=t.deps;n;n=n.nextDep)le(n)}const r=e.dep.subs;r!==e&&(e.prevSub=r,r&&(r.nextSub=e)),e.dep.subs=e}const N=new WeakMap,S=Symbol(""),J=Symbol(""),H=Symbol("");function g(e,t,r){if(y&&d){let n=N.get(e);n||N.set(e,n=new Map);let s=n.get(r);s||(n.set(r,s=new Q),s.target=e,s.map=n,s.key=r),s.track()}}function v(e,t,r,n,s,o){const a=N.get(e);if(!a){A++;return}const i=c=>{c&&c.trigger()};if(V(),t==="clear")a.forEach(i);else{const c=I(e),f=c&&G(r);if(c&&r==="length"){const l=Number(n);a.forEach((u,p)=>{(p==="length"||p===H||!j(p)&&p>=l)&&i(u)})}else switch(r!==void 0&&i(a.get(r)),f&&i(a.get(H)),t){case"add":c?f&&i(a.get("length")):(i(a.get(S)),C(e)&&i(a.get(J)));break;case"delete":c||(i(a.get(S)),C(e)&&i(a.get(J)));break;case"set":C(e)&&i(a.get(S));break}}X()}function L(e){const t=h(e);return t===e?t:(g(t,"iterate",H),T(e)?t:t.map(b))}function Z(e){return g(e=h(e),"iterate",H),e}const We={__proto__:null,[Symbol.iterator](){return ee(this,Symbol.iterator,b)},concat(...e){return L(this).concat(...e.map(t=>I(t)?L(t):t))},entries(){return ee(this,"entries",e=>(e[1]=b(e[1]),e))},every(e,t){return m(this,"every",e,t,void 0,arguments)},filter(e,t){return m(this,"filter",e,t,r=>r.map(b),arguments)},find(e,t){return m(this,"find",e,t,b,arguments)},findIndex(e,t){return m(this,"findIndex",e,t,void 0,arguments)},findLast(e,t){return m(this,"findLast",e,t,b,arguments)},findLastIndex(e,t){return m(this,"findLastIndex",e,t,void 0,arguments)},forEach(e,t){return m(this,"forEach",e,t,void 0,arguments)},includes(...e){return te(this,"includes",e)},indexOf(...e){return te(this,"indexOf",e)},join(e){return L(this).join(e)},lastIndexOf(...e){return te(this,"lastIndexOf",e)},map(e,t){return m(this,"map",e,t,void 0,arguments)},pop(){return x(this,"pop")},push(...e){return x(this,"push",e)},reduce(e,...t){return fe(this,"reduce",e,t)},reduceRight(e,...t){return fe(this,"reduceRight",e,t)},shift(){return x(this,"shift")},some(e,t){return m(this,"some",e,t,void 0,arguments)},splice(...e){return x(this,"splice",e)},toReversed(){return L(this).toReversed()},toSorted(e){return L(this).toSorted(e)},toSpliced(...e){return L(this).toSpliced(...e)},unshift(...e){return x(this,"unshift",e)},values(){return ee(this,"values",b)}};function ee(e,t,r){const n=Z(e),s=n[t]();return n!==e&&!T(e)&&(s._next=s.next,s.next=()=>{const o=s._next();return o.value&&(o.value=r(o.value)),o}),s}const $e=Array.prototype;function m(e,t,r,n,s,o){const a=Z(e),i=a!==e&&!T(e),c=a[t];if(c!==$e[t]){const u=c.apply(e,o);return i?b(u):u}let f=r;a!==e&&(i?f=function(u,p){return r.call(this,b(u),p,e)}:r.length>2&&(f=function(u,p){return r.call(this,u,p,e)}));const l=c.call(a,f,n);return i&&s?s(l):l}function fe(e,t,r,n){const s=Z(e);let o=r;return s!==e&&(T(e)?r.length>3&&(o=function(a,i,c){return r.call(this,a,i,c,e)}):o=function(a,i,c){return r.call(this,a,b(i),c,e)}),s[t](o,...n)}function te(e,t,r){const n=h(e);g(n,"iterate",H);const s=n[t](...r);return(s===-1||s===!1)&&ct(r[0])?(r[0]=h(r[0]),n[t](...r)):s}function x(e,t,r=[]){Ne(),V();const n=h(e)[t].apply(e,r);return X(),Ke(),n}const Be=Le("__proto__,__v_isRef,__isVue"),he=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(j));function Ye(e){j(e)||(e=String(e));const t=h(this);return g(t,"has",e),t.hasOwnProperty(e)}class de{constructor(t=!1,r=!1){this._isReadonly=t,this._isShallow=r}get(t,r,n){const s=this._isReadonly,o=this._isShallow;if(r==="__v_isReactive")return!s;if(r==="__v_isReadonly")return s;if(r==="__v_isShallow")return o;if(r==="__v_raw")return n===(s?o?ot:ye:o?nt:me).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(n)?t:void 0;const a=I(t);if(!s){let c;if(a&&(c=We[r]))return c;if(r==="hasOwnProperty")return Ye}const i=Reflect.get(t,r,q(t)?t:n);return(j(r)?he.has(r):Be(r))||(s||g(t,"get",r),o)?i:q(i)?a&&G(r)?i:i.value:U(i)?s?Re(i):ve(i):i}}class ze extends de{constructor(t=!1){super(!1,t)}set(t,r,n,s){let o=t[r];if(!this._isShallow){const c=P(o);if(!T(n)&&!P(n)&&(o=h(o),n=h(n)),!I(t)&&q(o)&&!q(n))return c?!1:(o.value=n,!0)}const a=I(t)&&G(r)?Number(r)<t.length:z(t,r),i=Reflect.set(t,r,n,q(t)?t:s);return t===h(s)&&(a?D(n,o)&&v(t,"set",r,n):v(t,"add",r,n)),i}deleteProperty(t,r){const n=z(t,r);t[r];const s=Reflect.deleteProperty(t,r);return s&&n&&v(t,"delete",r,void 0),s}has(t,r){const n=Reflect.has(t,r);return(!j(r)||!he.has(r))&&g(t,"has",r),n}ownKeys(t){return g(t,"iterate",I(t)?"length":S),Reflect.ownKeys(t)}}class Ge extends de{constructor(t=!1){super(!0,t)}set(t,r){return!0}deleteProperty(t,r){return!0}}const Ve=new ze,Xe=new Ge,re=e=>e,K=e=>Reflect.getPrototypeOf(e);function F(e,t,r=!1,n=!1){e=e.__v_raw;const s=h(e),o=h(t);r||(D(t,o)&&g(s,"get",t),g(s,"get",o));const{has:a}=K(s),i=n?re:r?se:b;if(a.call(s,t))return i(e.get(t));if(a.call(s,o))return i(e.get(o));e!==s&&e.get(t)}function W(e,t=!1){const r=this.__v_raw,n=h(r),s=h(e);return t||(D(e,s)&&g(n,"has",e),g(n,"has",s)),e===s?r.has(e):r.has(e)||r.has(s)}function $(e,t=!1){return e=e.__v_raw,!t&&g(h(e),"iterate",S),Reflect.get(e,"size",e)}function pe(e,t=!1){!t&&!T(e)&&!P(e)&&(e=h(e));const r=h(this);return K(r).has.call(r,e)||(r.add(e),v(r,"add",e,e)),this}function be(e,t,r=!1){!r&&!T(t)&&!P(t)&&(t=h(t));const n=h(this),{has:s,get:o}=K(n);let a=s.call(n,e);a||(e=h(e),a=s.call(n,e));const i=o.call(n,e);return n.set(e,t),a?D(t,i)&&v(n,"set",e,t):v(n,"add",e,t),this}function ge(e){const t=h(this),{has:r,get:n}=K(t);let s=r.call(t,e);s||(e=h(e),s=r.call(t,e)),n&&n.call(t,e);const o=t.delete(e);return s&&v(t,"delete",e,void 0),o}function _e(){const e=h(this),t=e.size!==0,r=e.clear();return t&&v(e,"clear",void 0,void 0),r}function B(e,t){return function(n,s){const o=this,a=o.__v_raw,i=h(a),c=t?re:e?se:b;return!e&&g(i,"iterate",S),a.forEach((f,l)=>n.call(s,c(f),c(l),o))}}function Y(e,t,r){return function(...n){const s=this.__v_raw,o=h(s),a=C(o),i=e==="entries"||e===Symbol.iterator&&a,c=e==="keys"&&a,f=s[e](...n),l=r?re:t?se:b;return!t&&g(o,"iterate",c?J:S),{next(){const{value:u,done:p}=f.next();return p?{value:u,done:p}:{value:i?[l(u[0]),l(u[1])]:l(u),done:p}},[Symbol.iterator](){return this}}}}function R(e){return function(...t){return e==="delete"?!1:e==="clear"?void 0:this}}function Qe(){const e={get(o){return F(this,o)},get size(){return $(this)},has:W,add:pe,set:be,delete:ge,clear:_e,forEach:B(!1,!1)},t={get(o){return F(this,o,!1,!0)},get size(){return $(this)},has:W,add(o){return pe.call(this,o,!0)},set(o,a){return be.call(this,o,a,!0)},delete:ge,clear:_e,forEach:B(!1,!0)},r={get(o){return F(this,o,!0)},get size(){return $(this,!0)},has(o){return W.call(this,o,!0)},add:R("add"),set:R("set"),delete:R("delete"),clear:R("clear"),forEach:B(!0,!1)},n={get(o){return F(this,o,!0,!0)},get size(){return $(this,!0)},has(o){return W.call(this,o,!0)},add:R("add"),set:R("set"),delete:R("delete"),clear:R("clear"),forEach:B(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(o=>{e[o]=Y(o,!1,!1),r[o]=Y(o,!0,!1),t[o]=Y(o,!1,!0),n[o]=Y(o,!0,!0)}),[e,r,t,n]}const[Je,Ze,et,tt]=Qe();function we(e,t){const r=t?e?tt:et:e?Ze:Je;return(n,s,o)=>s==="__v_isReactive"?!e:s==="__v_isReadonly"?e:s==="__v_raw"?n:Reflect.get(z(r,s)&&s in n?r:n,s,o)}const rt={get:we(!1,!1)},st={get:we(!0,!1)},me=new WeakMap,nt=new WeakMap,ye=new WeakMap,ot=new WeakMap;function it(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function at(e){return e.__v_skip||!Object.isExtensible(e)?0:it(ke(e))}function ve(e){return P(e)?e:Te(e,!1,Ve,rt,me)}function Re(e){return Te(e,!0,Xe,st,ye)}function Te(e,t,r,n,s){if(!U(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const o=s.get(e);if(o)return o;const a=at(e);if(a===0)return e;const i=new Proxy(e,a===2?n:r);return s.set(e,i),i}function P(e){return!!(e&&e.__v_isReadonly)}function T(e){return!!(e&&e.__v_isShallow)}function ct(e){return e?!!e.__v_raw:!1}function h(e){const t=e&&e.__v_raw;return t?h(t):e}const b=e=>U(e)?ve(e):e,se=e=>U(e)?Re(e):e;function q(e){return e?e.__v_isRef===!0:!1}function ne(e){return ut(e,!1)}function ut(e,t){return q(e)?e:new lt(e,t)}class lt{constructor(t,r){this.dep=new Q,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=r?t:h(t),this._value=r?t:b(t),this.__v_isShallow=r}get value(){return this.dep.track(),this._value}set value(t){const r=this._rawValue,n=this.__v_isShallow||T(t)||P(t);t=n?t:h(t),D(t,r)&&(this._rawValue=t,this._value=n?t:b(t),this.dep.trigger())}}class ft{constructor(t,r,n){this.fn=t,this.setter=r,this._value=void 0,this.dep=new Q(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=A-1,this.effect=this,this.__v_isReadonly=!r,this.isSSR=n}notify(){if(this.flags|=16,!(this.flags&8)&&d!==this)return Ae(this),!0}get value(){const t=this.dep.track();return ae(this),t&&(t.version=this.dep.version),this._value}set value(t){this.setter&&this.setter(t)}}function ht(e,t,r=!1){let n,s;return qe(e)?n=e:(n=e.get,s=e.set),new ft(n,s,r)}/**
 * Fexios
 * @desc Fetch based HTTP client with similar API to axios for browser and Node.js
 *
 * @license MIT
 * @author dragon-fish <dragon-fish@qq.com>
 */class M{constructor(t={}){this.baseConfigs=t,this.hooks=[],this.DEFAULT_CONFIGS={baseURL:"",timeout:6e4,credentials:"same-origin",headers:{},query:{},responseType:"json"},this.ALL_METHODS=["get","post","put","patch","delete","head","options","trace"],this.METHODS_WITHOUT_BODY=["get","head","options","trace"],this.interceptors={request:this.createInterceptor("beforeRequest"),response:this.createInterceptor("afterResponse")},this.create=M.create,this.ALL_METHODS.forEach(this.createMethodShortcut.bind(this))}async request(t,r){var n,s,o,a;let i=r=r||{};i.url=t.toString(),i=await this.emit("beforeInit",i);const c=r.baseURL||this.baseConfigs.baseURL||((n=globalThis.location)==null?void 0:n.href),f=c?new URL(c,(s=globalThis.location)==null?void 0:s.href):void 0,l=new URL(i.url.toString(),f);if(i.url=l.href,i.baseURL=f?f.href:l.origin,i.headers=this.mergeHeaders(this.baseConfigs.headers,r.headers),i.query=this.mergeQuery(this.baseConfigs.query,l.searchParams,r.query),l.search=new URLSearchParams(i.query).toString(),i.url=l.toString(),this.METHODS_WITHOUT_BODY.includes((o=i.method)==null?void 0:o.toLocaleLowerCase())&&i.body)throw new E("BODY_NOT_ALLOWED",`Request method "${i.method}" does not allow body`);i=await this.emit("beforeRequest",i);let u;typeof i.body<"u"&&i.body!==null&&(i.body instanceof Blob||i.body instanceof FormData||i.body instanceof URLSearchParams?u=i.body:typeof i.body=="object"?(u=JSON.stringify(i.body),i.headers["content-type"]="application/json; charset=UTF-8"):u=i.body),!((a=r.headers)!=null&&a["content-type"])&&u&&(u instanceof FormData||u instanceof URLSearchParams?typeof u=="string"&&typeof i.body=="object"?i.headers["content-type"]="application/json; charset=UTF-8":u instanceof Blob&&(i.headers["content-type"]=u.type):delete i.headers["content-type"]),i.body=u,i=await this.emit("afterBodyTransformed",i);const p=i.abortController||globalThis.AbortController?new AbortController:void 0,bt=new Request(i.url,{method:i.method||"GET",credentials:i.credentials,headers:i.headers,body:i.body,signal:p==null?void 0:p.signal});i.rawRequest=bt,i=await this.emit("beforeActualFetch",i);const Ie=i.timeout||this.baseConfigs.timeout||60*1e3,gt=setTimeout(()=>{if(p==null||p.abort(),!p)throw new E("TIMEOUT",`Request timed out after ${Ie}ms`,i)},Ie),De=await fetch(i.rawRequest).catch(_t=>{throw new E("NETWORK_ERROR",_t.message,i)}).finally(()=>{clearTimeout(gt)});return i.rawResponse=De,i.response=await pt(De,i.responseType),i.data=i.response.data,i.headers=i.response.headers,this.emit("afterResponse",i)}mergeQuery(t,...r){const n=new URLSearchParams(t);for(const s of r)new URLSearchParams(s).forEach((o,a)=>{n.set(a,o)});return Object.fromEntries(n)}mergeHeaders(t,...r){const n={},s=new Headers(t);for(const o of r)new Headers(o).forEach((a,i)=>{s.set(i,a)});return s.forEach((o,a)=>{n[a]=o}),n}async emit(t,r){const n=this.hooks.filter(s=>s.event===t);try{let s=0;for(const o of n){const a=`${t}#${o.action.name||s}`,i=Symbol("FexiosHookContext");r.__hook_symbol__=i;const c=await o.action.bind(this)(r);if(r.__hook_symbol__!==i)throw new E("HOOK_CONTEXT_CHANGED",`Hook "${a}" should not override the original FexiosContext object.`);if(c===!1)throw new E("ABORTED_BY_HOOK",`Request aborted by hook "${a}"`,r);if(typeof c=="object"&&c.__hook_symbol__===i)r=c;else{const f=globalThis["".concat("console")];try{throw new E("UNEXPECTED_HOOK_RETURN",`Hook "${a}" should return the original FexiosContext or return false to abort the request, but got "${c}".`)}catch(l){f.warn(l.stack||l)}}delete r.__hook_symbol__,s++}}catch(s){return Promise.reject(s)}return r}on(t,r,n=!1){if(typeof r!="function")throw new E("INVALID_HOOK_CALLBACK",`Hook "${r}" should be a function, but got "${typeof r}"`);return this.hooks[n?"unshift":"push"]({event:t,action:r}),this}createInterceptor(t){return{handlers:()=>this.hooks.filter(r=>r.event===t).map(r=>r.action),use:(r,n=!1)=>this.on(t,r,n),clear:()=>{this.hooks=this.hooks.filter(r=>r.event!==t)}}}createMethodShortcut(t){return Object.defineProperty(this,t,{value:(r,n,s)=>(this.METHODS_WITHOUT_BODY.includes(t.toLocaleLowerCase())?s=n:(s=s||{},s.body=n),this.request(r,{...s,method:t}))}),this}extends(t){const r=new M({...this.baseConfigs,...t});return r.hooks=[...this.hooks],r}static create(t){return new M(t)}}class E extends Error{constructor(t,r,n){super(r),this.code=t,this.context=n,this.name="FexiosError"}}class dt extends E{constructor(t,r){super(r.statusText,t),this.response=r,this.name="FexiosResponseError"}}async function pt(e,t="json"){let r;t==="blob"&&(r=await e.clone().blob().catch(()=>{})),r||(r=await e.clone().json().catch(()=>e.clone().text()));const n={rawResponse:e,data:r,ok:e.ok,status:e.status,statusText:e.statusText,headers:e.headers};if(!e.ok)throw new dt(`Request failed with status code ${e.status}`,n);return n}Ee();function Ee(e){return M.create(e)}typeof window<"u"&&(window.fexios=Ee());/**
 * MediaWiki Api for Axios
 * Provides the API call methods similar to `mw.Api` at non-mw environments
 *
 * @author Dragon-Fish <dragon-fish@qq.com>
 * @license MIT
 */class _{constructor(t,r){var n,s;if(this.cookies={},!t&&typeof window=="object"&&window.mediaWiki){const{wgServer:o,wgScriptPath:a}=((s=(n=window.mediaWiki)==null?void 0:n.config)==null?void 0:s.get(["wgServer","wgScriptPath"]))||{};typeof o=="string"&&typeof a=="string"&&(t=`${o}${a}/api.php`)}if(typeof t!="string")throw new Error("baseURL is undefined");this.baseURL=ne(t),this.tokens={},this.defaultParamsRef=ne({}),this.defaultOptionsRef=ne({}),this.defaultParams={action:"query",errorformat:"plaintext",format:"json",formatversion:2},this.defaultOptions=r||{},this.requestHandlerRef=ht(()=>{const o=_.createRequestHandler(this.baseURL.value,{...this.defaultOptions,query:this.defaultParams});return"document"in globalThis||(o.interceptors.request.use(a=>(a.headers=a.headers||{},a.headers.cookie=Object.keys(this.cookies).map(i=>`${i}=${this.cookies[i]}`).join(";"),a)),o.interceptors.response.use(a=>{const i=a.rawResponse.headers.get("set-cookie"),c=i==null?void 0:i.split(",").map(f=>f.trim());return c==null||c.forEach(f=>{const[l,...u]=f.split(";")[0].split("=");this.cookies[l]=u.join("=")}),a})),o})}static normalizeParamValue(t){return Array.isArray(t)?t.join("|"):typeof t=="boolean"?t?"1":void 0:typeof t=="number"?""+t:t}static createRequestHandler(t,r={}){const n=new M(r);return n.baseConfigs.baseURL=t,n.on("beforeInit",s=>{var o;if(((o=s.method)==null?void 0:o.toLowerCase())!=="post")return s;if(typeof s.body=="object"&&s.body!==null&&!(s.body instanceof URLSearchParams)&&!(s.body instanceof FormData)){const a=s.body;Object.keys(a).forEach(i=>{const c=_.normalizeParamValue(a[i]);typeof c>"u"||c===null?delete a[i]:c!==a[i]&&(a[i]=c)}),s.body=new URLSearchParams(s.body)}if(globalThis.FormData&&s.body instanceof FormData||s.body instanceof URLSearchParams){const a=s.body;a.forEach((c,f)=>{const l=_.normalizeParamValue(c);typeof l>"u"||l===null?a.delete(f):l!==c&&a.set(f,l)});const i=new URLSearchParams(s.query);!i.has("format")&&i.set("format",""+(a.get("format")||"json")),!i.has("formatversion")&&i.set("formatversion",""+(a.get("formatversion")||"2")),a.has("origin")&&i.set("origin",""+a.get("origin")),s.query=Object.fromEntries(i),a.has("action")&&(s.query.action=""+a.get("action"))}return s}),n.on("beforeInit",s=>{s.query=s.query;for(const o in s.query){const a=_.normalizeParamValue(s.query[o]);typeof a>"u"||a===null?delete s.query[o]:a!==s.query[o]&&(s.query[o]=""+a)}return s}),n.on("beforeRequest",s=>{const o=new URL(s.url);if(o.searchParams.has("origin")){const a=encodeURIComponent(o.searchParams.get("origin")||"").replace(/\./g,"%2E");s.query={},o.searchParams.delete("origin"),s.url=`${o}${o.search?"&":"?"}origin=${a}`}return s}),n}get request(){return this.requestHandlerRef.value}get defaultOptions(){return this.defaultOptionsRef.value}set defaultOptions(t){this.defaultOptionsRef.value=t}get defaultParams(){return this.defaultParamsRef.value}set defaultParams(t){this.defaultParamsRef.value=t}get(t,r){return this.request.get("",{query:t,...r})}post(t,r){return this.request.post("",t,r)}async login(t,r,n,s){var a,i,c,f,l;if(this.defaultOptions.credentials="include",s=s||{},s.retry??(s.retry=3),s.retry<1)throw new O("LOGIN_RETRY_LIMIT_EXCEEDED","The limit of the number of times to automatically re-login has been exceeded");let o;try{const u=await this.postWithToken("login",{action:"login",lgname:t,lgpassword:r,...n},{tokenName:"lgtoken",...s});if((a=u==null?void 0:u.data)!=null&&a.login)o=u.data;else throw u}catch(u){if(u instanceof O)throw u;if((u==null?void 0:u.ok)===!1)return this.login(t,r,n,{...s,noCache:!0,retry:s.retry-1});throw new O("HTTP_ERROR","The server returns an error, but it doesn't seem to be caused by MediaWiki",u)}if(((i=o==null?void 0:o.login)==null?void 0:i.result)!=="Success")throw new O("LOGIN_FAILED",((f=(c=o==null?void 0:o.login)==null?void 0:c.reason)==null?void 0:f.text)||((l=o==null?void 0:o.login)==null?void 0:l.result)||"Login failed with unknown reason",o);return o.login}async getUserInfo(){var r;const{data:t}=await this.get({action:"query",meta:"userinfo",uiprop:["groups","rights","blockinfo"]});return(r=t==null?void 0:t.query)==null?void 0:r.userinfo}async getTokens(t=["csrf"]){this.defaultOptions.credentials="include";const{data:r}=await this.get({action:"query",meta:"tokens",type:t});return this.tokens={...this.tokens,...r.query.tokens},this.tokens}async token(t="csrf",r=!1){return(!this.tokens[`${t}token`]||r)&&(delete this.tokens[`${t}token`],await this.getTokens([t])),this.tokens[`${t}token`]}async postWithToken(t,r,n){const{tokenName:s="token",retry:o=3,noCache:a=!1}=n||{};if(o<1)throw new O("TOKEN_RETRY_LIMIT_EXCEEDED","The limit of the number of times to automatically re-acquire the token has been exceeded");const i=await this.token(t,a),c=()=>this.postWithToken(t,r,{tokenName:s,retry:o-1,noCache:!0});return this.post({[s]:i,...r}).then(f=>{const l=f.data;return _.isBadTokenError(l)?c():f}).catch(f=>{const l=f.data;if(_.isBadTokenError(l)||(f==null?void 0:f.ok)===!1)return c();if(typeof l=="object"&&l!==null)return Promise.reject(l);throw new O("HTTP_ERROR","The server returns an error, but it doesn’t seem to be caused by MediaWiki",f)})}postWithEditToken(t){return this.postWithToken("csrf",t)}static isBadTokenError(t){var r,n,s;return((r=t==null?void 0:t.error)==null?void 0:r.code)==="badtoken"||((n=t==null?void 0:t.errors)==null?void 0:n.some(o=>o.code==="badtoken"))||["NeedToken","WrongToken"].includes((s=t==null?void 0:t.login)==null?void 0:s.result)}async getMessages(t,r="zh",n){const{data:s}=await this.get({action:"query",meta:"allmessages",ammessages:t,amlang:r,...n}),o={};return s.query.allmessages.forEach(function(a){a.missing||(o[a.name]=a.content)}),o}async parseWikitext(t,r,n,s){const{data:o}=await this.post({action:"parse",title:r,text:t,...n},s);return o.parse.text}}class Se extends _{constructor(t,r){super(t,{credentials:"include",...r}),this.defaultParams.origin=location.origin}}var Oe=(e=>(e.HTTP_ERROR="HTTP_ERROR",e.LOGIN_FAILED="LOGIN_FAILED",e.LOGIN_RETRY_LIMIT_EXCEEDED="LOGIN_RETRY_LIMIT_EXCEEDED",e.TOKEN_RETRY_LIMIT_EXCEEDED="TOKEN_RETRY_LIMIT_EXCEEDED",e))(Oe||{});class O extends Error{constructor(t,r="",n){super(),this.code=t,this.message=r,this.cause=n,this.name="WikiSaikouError"}}return w.ForeignApi=Se,w.MediaWikiApi=_,w.MediaWikiForeignApi=Se,w.MwApi=_,w.WikiSaikouError=O,w.WikiSaikouErrorCode=Oe,w.default=_,Object.defineProperties(w,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}}),w}({});
//# sourceMappingURL=index.iife.js.map
